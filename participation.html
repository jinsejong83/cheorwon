<!DOCTYPE html>
      checkAdmin(user);
    });

    async function loadParticipation() {
      const eventsSnapshot = await getDocs(collection(db, "events"));
      const membersSnapshot = await getDocs(collection(db, "members"));
      const participationTable = document.getElementById("participation-table-body");

      participationTable.innerHTML = "";

      membersSnapshot.forEach((memberDoc) => {
        const memberData = memberDoc.data();
        let row = `<tr><td>${memberData.companyName}</td>`;

        eventsSnapshot.forEach((eventDoc) => {
          const eventData = eventDoc.data();
          const cellId = `${memberDoc.id}_${eventDoc.id}`;
          row += `<td>
            <input type="checkbox" id="${cellId}" onchange="updateParticipation('${memberDoc.id}', '${eventDoc.id}')" disabled>
          </td>`;
        });

        row += "</tr>";
        participationTable.innerHTML += row;
      });

      loadCheckedParticipation();
    }

    async function loadCheckedParticipation() {
      const participationSnapshot = await getDocs(collection(db, "participation"));
      participationSnapshot.forEach((doc) => {
        const data = doc.data();
        document.getElementById(`${data.memberId}_${data.eventId}`).checked = true;
      });

      if (isAdmin) {
        document.querySelectorAll("input[type=checkbox]").forEach(checkbox => {
          checkbox.disabled = false;
        });
      }
    }

    async function updateParticipation(memberId, eventId) {
      if (!isAdmin) return;
      const checkBox = document.getElementById(`${memberId}_${eventId}`);
      const participationRef = doc(db, "participation", `${memberId}_${eventId}`);

      if (checkBox.checked) {
        await setDoc(participationRef, { memberId, eventId });
      } else {
        await deleteDoc(participationRef);
      }
    }

    document.addEventListener("DOMContentLoaded", loadParticipation);
  </script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #e0f7fa;
      text-align: center;
    }

    header {
      background-color: #ffffff;
      padding: 10px 0;
      text-align: center;
    }

    header img {
      max-width: 90%;
      height: auto;
      object-fit: contain;
      margin: 5px auto;
      display: block;
      cursor: pointer;
    }

    header p {
      font-size: 1.2rem;
      margin: 0;
      text-align: center;
      word-break: break-word;
      white-space: normal;
      padding: 0;
      line-height: 1.4;
    }

    @media (max-width: 768px) {
      header p {
        font-size: 1.1rem;
        line-height: 1.2;
        display: block;
      }
    }

    main { max-width: 800px;
      margin: 20px auto;
      padding: 20px;
